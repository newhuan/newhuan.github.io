# Mysql笔记

mysql读取数据的时候都是从**内存页**中读取的，如果需要的数据页还没加载到内存中，则要从磁盘中读取并加载到内存页中。

所以Mysql的数据可以说**本质**就是内存页的数据，然后内存页中改动了但是还没写入磁盘的**脏页**会放在flush链表中找机会写入磁盘。



所以redo log的**崩溃恢复**就是要保证那些：事务本身已经提交了的(redo log已经被改为commit状态（此redo log的commit和事务的commit不是一回事）)，但是事务的改动还没写入磁盘的**事务**能真实生效（既保证事务的持久性（只要提交了事务，就一定会生效））



所以redo log得**崩溃恢复**就是恢复内存页到正确的状态，正确的状态既：所有应该生效的改动都正确生效的状态



Undo log针对的是那些: **事务还没有提交，但是redo log已经被标记为commit的redo log** 

这类redo log在崩溃恢复的时候会生效并修改内存页，此时需要根据undo log的机制找到那些**未提交的事务**对应的undo log,并根据该undo log把内存页恢复到正确的状态，正确的状态既：所有应该生效的改动都正确生效的状态



redo log和undo log都是InnoDB的机制，用于保证InnoDb的事务的ACID(原子性、一致性、持久性、隔离性；这两个日志看起来和隔离性没什么关系)；

binlog是Mysql的机制，仅讨论保证事务的ACID的正确性的话，是不需要binlog的，binlog主要用于主从同步、数据恢复、同步到数据分析系统等业务需求

所以redo log、undo log、内存页、磁盘数据页等都是**事务**ACID等正确性的保证

事务的ACID是InnoDB（存储引擎）来保证的，和Mysql(数据库)本身没什么关系，InnoDB是后来才被加入到Mysql中的